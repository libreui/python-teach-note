# 健身房会员管理系统（增强逻辑版）

## 一、类的设计

### （一）基础信息类
1. **地址类（`Address`）**
    - **属性**：
        - `street`：街道地址
        - `city`：城市
        - `postal_code`：邮政编码
    - **方法**：
        - `__repr__(self)`：返回地址的字符串表示，格式为“[街道地址], [城市], [邮政编码]”。

2. **日期范围类（`DateRange`）**
    - **属性**：
        - `start_date`：开始日期（使用Python的`datetime`模块）
        - `end_date`：结束日期（使用Python的`datetime`模块）
    - **方法**：
        - `is_within_range(self, target_date)`：判断传入的`target_date`是否在当前日期范围内，返回布尔值。

### （二）会员等级类（抽象基类`MemberLevel`）
1. **属性**：
    - `discount_rate`：会员等级对应的折扣率（抽象属性，由子类具体实现）
    - `level_name`：会员等级名称（抽象属性，由子类具体实现）
    - `privileges`：会员等级对应的特权列表（抽象属性，由子类具体实现，例如免费私教课次数、优先预约场地等）
    - `upgrade_requirements`：升级到该等级所需的条件，是一个包含总消费金额和出勤次数的字典，例如`{"total_consumption": 1000, "attendance_count": 20}`（抽象属性，由子类具体实现）
2. **方法**：
    - `get_discount()`：返回该会员等级对应的折扣率。
    - `get_level_name()`：返回该会员等级的名称。
    - `get_privileges()`：返回该会员等级对应的特权列表。
    - `check_upgrade_eligibility(self, member)`：根据传入的会员对象，检查是否满足升级到该等级的条件，返回布尔值。

### （三）具体会员等级类
1. **普通会员类（`NormalMember`）继承自`MemberLevel`**
    - **属性**：
        - `discount_rate`：普通会员折扣率为1.0（无折扣）
        - `level_name`：“普通会员”
        - `privileges`：空列表（普通会员无特殊特权）
        - `upgrade_requirements`：`{"total_consumption": 1000, "attendance_count": 20}`
    - **方法**：
        - 继承自`MemberLevel`的`get_discount()`、`get_level_name()`、`get_privileges()`和`check_upgrade_eligibility()`方法，实现普通会员等级相关的功能。

2. **银卡会员类（`SilverMember`）继承自`MemberLevel`**
    - **属性**：
        - `discount_rate`：银卡会员折扣率为0.9（9折）
        - `level_name`：“银卡会员”
        - `privileges`：例如 `["每月1节免费私教课", "优先预约场地"]`
        - `upgrade_requirements`：`{"total_consumption": 3000, "attendance_count": 50}`
    - **方法**：
        - 继承自`MemberLevel`的`get_discount()`、`get_level_name()`、`get_privileges()`和`check_upgrade_eligibility()`方法，实现银卡会员等级相关的功能。

3. **金卡会员类（`GoldMember`）继承自`MemberLevel`**
    - **属性**：
        - `discount_rate`：金卡会员折扣率为0.8（8折）
        - `level_name`：“金卡会员”
        - `privileges`：例如 `["每月3节免费私教课", "优先预约场地", "专属更衣室"]`
        - `upgrade_requirements`：`{"total_consumption": 5000, "attendance_count": 80}`
    - **方法**：
        - 继承自`MemberLevel`的`get_discount()`、`get_level_name()`、`get_privileges()`和`check_upgrade_eligibility()`方法，实现金卡会员等级相关的功能。

### （四）消费相关类
1. **消费项目类（`ConsumptionItem`）**
    - **属性**：
        - `item_name`：消费项目名称
        - `base_price`：消费项目的基础价格
    - **方法**：
        - `get_price(self, member)`：根据传入的会员对象，计算该会员消费此项目的实际价格，考虑会员折扣率。

2. **消费记录类（`ConsumptionRecord`）**
    - **属性**：
        - `member`：关联的会员对象
        - `item`：消费项目对象（`ConsumptionItem`类实例）
        - `timestamp`：消费时间（使用Python的`datetime`模块）
    - **方法**：
        - `get_amount(self)`：返回本次消费的实际金额，调用`item`的`get_price`方法获取。
        - `__repr__(self)`：返回消费记录的字符串表示，格式为“[会员姓名]于[消费时间]消费[消费项目名称]，金额为[实际金额]元”。

### （五）会员类（`Member`）
1. **属性**：
    - `member_id`：会员ID（唯一标识，例如使用UUID或者递增数字）
    - `name`：会员姓名
    - `phone`：会员联系电话
    - `address`：会员地址对象（`Address`类实例）
    - `member_level`：会员等级对象（初始为普通会员，对应`NormalMember`类实例，后续可升级）
    - `consumption_records`：会员消费记录列表，每个记录是一个`ConsumptionRecord`类的实例
    - `attendance_records`：会员出勤记录列表，每个记录是一个日期（使用Python的`datetime`模块）
    - `membership_period`：会员的会籍有效期，是一个`DateRange`类实例
2. **方法**：
    - `update_contact_info(new_phone)`：更新会员的联系电话。
    - `update_address(new_address)`：更新会员的地址，`new_address`是一个`Address`类实例。
    - `add_consumption_record(item, timestamp)`：创建一个新的`ConsumptionRecord`实例并添加到`consumption_records`列表，`item`是一个`ConsumptionItem`类实例。
    - `get_total_consumption()`：计算并返回会员的总消费金额，遍历`consumption_records`列表，累加每个记录的`get_amount`方法返回值。
    - `add_attendance_record(date)`：添加一条出勤记录到`attendance_records`列表，`date`为出勤日期。
    - `get_attendance_count()`：返回会员的出勤次数，即`attendance_records`列表的长度。
    - `upgrade_membership()`：检查会员是否满足升级条件，通过调用当前会员等级对象的`check_upgrade_eligibility`方法。如果满足条件，升级会员等级，并打印升级信息。
    - `is_membership_valid(self, target_date)`：判断在传入的`target_date`时会员的会籍是否有效，通过调用`membership_period`的`is_within_range`方法。
    - `display_consumption_records()`：遍历并打印`consumption_records`列表中每个消费记录的字符串表示。
    - `display_attendance_records()`：遍历并打印`attendance_records`列表中的每个出勤日期。

### （六）健身房类（`Gym`）
1. **属性**：
    - `members`：健身房会员列表，每个元素是一个`Member`类实例
    - `consumption_items`：健身房提供的消费项目列表，每个元素是一个`ConsumptionItem`类实例
2. **方法**：
    - `add_member(self, member)`：将会员添加到`members`列表。
    - `remove_member(self, member_id)`：根据会员ID从`members`列表中移除会员。
    - `add_consumption_item(self, item)`：将消费项目添加到`consumption_items`列表。
    - `get_member_by_id(self, member_id)`：根据会员ID在`members`列表中查找并返回会员对象，如果未找到则返回`None`。
    - `get_total_consumption_by_period(self, start_date, end_date)`：计算在指定日期范围内所有会员的总消费金额。遍历`members`列表，对每个会员的`consumption_records`进行筛选，只计算在指定日期范围内的消费记录金额并累加。

## 二、程序要求
1. 创建健身房对象，并添加一些消费项目。
2. 创建多个会员对象，设置不同的初始信息和会籍有效期。
3. 为每个会员添加一些消费记录和出勤记录。
4. 展示每个会员升级前的等级、总消费金额和出勤次数。
5. 调用每个会员的`upgrade_membership()`方法，展示升级后的等级。
6. 模拟一次消费场景，选择一个会员和一个消费项目，根据会员等级计算并打印出实际需要支付的金额。
7. 调用会员的`display_consumption_records()`和`display_attendance_records()`方法，展示会员的消费记录和出勤记录。
8. 使用健身房对象，计算并展示在某个日期范围内所有会员的总消费金额。
9. 检查某个会员在特定日期的会籍有效性，并打印相应信息。

通过这个更复杂的设计，进一步强化了面向对象编程中的类的继承、组合、多态等概念，以及如何运用这些概念来构建一个完整且逻辑丰富的业务系统。 